!function(e){var t={};function o(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=1)}([function(e,t){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){for(var o,n=0;n<t.length;n++)(o=t[n]).enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function i(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var a=wp.blocks.registerBlockType,u=wp.blockEditor.InspectorControls,s=wp.components,c=(s.Button,s.ButtonGroup,s.ExternalLink,s.Modal,s.PanelBody),p=(s.Placeholder,s.SelectControl),d=s.TextControl,f=wp.element,y=f.Component,b=f.Fragment;a("optio-dentistry/optio-library",{title:"Optio Dentistry Library",description:"Embed the entire Optio Dentistry library.",icon:"playlist-video",category:"optio-dentistry",attributes:{language:{type:"string",default:"en"},filter:{type:"string",default:""}},edit:function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,r(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,e),function(e,t,o){t&&n(e.prototype,t),o&&n(e,o)}(t,[{key:"render",value:function(){var e=this,t="optio-library-"+this.props.clientId;return wp.element.createElement(b,null,wp.element.createElement(u,null,wp.element.createElement(c,{title:"Library",initialOpen:!1},wp.element.createElement(p,{className:"optio-inspector__control",label:"Language",value:this.props.attributes.language,options:[{label:"English",value:"en"},{label:"Français",value:"fr"},{label:"Espanõl",value:"es"}],onChange:function(t){return e.props.setAttributes({language:t})}}),wp.element.createElement(d,{className:"optio-inspector__control",label:"Filter",value:this.props.attributes.filter,onChange:function(t){return e.props.setAttributes({filter:t})}}))),wp.element.createElement("div",{id:t}))}},{key:"componentDidMount",value:function(){var e=this,t="optio-library-"+this.props.clientId;"undefined"==typeof optio?addEventListener("load",(function(){optio.VideoLibrary(t,e.props.attributes.videoId)})):optio.VideoLibrary(t,this.props.attributes.videoId)}}]),t}(y),save:function(e){return'[optio-library language="'+e.attributes.language+'" filter="'+e.attributes.filter+'"]'}})},function(e,t,o){"use strict";o.r(t);o(0);function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var o,n=0;n<t.length;n++)(o=t[n]).enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function l(e,t,o){return t&&r(e.prototype,t),o&&r(e,o),e}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?s(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=wp.components,f=d.Button,y=d.ButtonGroup,b=d.Modal,m=wp.element,h=m.Component,v=(m.useState,function(e){function t(){var e;return i(this,t),(e=a(this,u(t).apply(this,arguments))).closeModal=e.closeModal.bind(s(e)),e.onSelectProduct=e.onSelectProduct.bind(s(e)),e.onSelectVideo=e.onSelectVideo.bind(s(e)),e.state={selected:0,products:[],videos:[]},e}return c(t,e),l(t,[{key:"componentDidMount",value:function(){jQuery.getJSON("https://www.optiopublishing.com/api/products",function(e){e.error||this.setState({products:e,videos:e[this.state.selected].videos})}.bind(this))}},{key:"closeModal",value:function(){this.props.onRequestClose()}},{key:"onSelectProduct",value:function(e){this.setState({selected:e,videos:this.state.products[e].videos})}},{key:"onSelectVideo",value:function(e){this.props.onSelectVideo(e),this.closeModal()}},{key:"render",value:function(){return this.props.isOpen&&wp.element.createElement(b,{className:"optio-video-modal",title:"Select a video",onRequestClose:this.props.onRequestClose},wp.element.createElement(w,{products:this.state.products,onSelectProduct:this.onSelectProduct}),wp.element.createElement(g,{videos:this.state.videos,onSelectVideo:this.onSelectVideo}))}}]),t}(h)),w=function(e){function t(){var e;return i(this,t),(e=a(this,u(t).apply(this,arguments))).selectProduct=e.selectProduct.bind(s(e)),e.state={selected:0},e}return c(t,e),l(t,[{key:"selectProduct",value:function(e){this.setState({selected:e}),this.props.onSelectProduct(e)}},{key:"render",value:function(){var e=this,t=this.props.products.map((function(t,o){return o==e.state.selected?wp.element.createElement(f,{isPrimary:!0,onClick:function(){e.selectProduct(o)}},t.title):wp.element.createElement(f,{isDefault:!0,onClick:function(){e.selectProduct(o)}},t.title)}));return wp.element.createElement(y,{className:"optio-product-list"},t)}}]),t}(h),g=function(e){function t(){var e;return i(this,t),(e=a(this,u(t).apply(this,arguments))).selectVideo=e.selectVideo.bind(s(e)),e}return c(t,e),l(t,[{key:"selectVideo",value:function(e){this.props.onSelectVideo(e)}},{key:"render",value:function(){var e=this,t=this.props.videos.map((function(t){return wp.element.createElement("li",{onClick:function(){e.selectVideo(t.id)}},wp.element.createElement("img",{src:t.thumbnail_url}),t.title)}));return wp.element.createElement("ul",{class:"optio-video-list"},t)}}]),t}(h),O=v;function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){for(var o,n=0;n<t.length;n++)(o=t[n]).enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var V=wp.blocks.registerBlockType,j=wp.blockEditor.InspectorControls,C=wp.components,I=C.Button,M=(C.ButtonGroup,C.ExternalLink),L=(C.Modal,C.PanelBody),D=C.Placeholder,T=C.SelectControl,x=C.TextControl,B=wp.element,N=B.Component,F=B.Fragment;function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){for(var o,n=0;n<t.length;n++)(o=t[n]).enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function G(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}V("optio-dentistry/optio-video",{title:"Optio Dentistry Video",description:"Embed a single Optio Dentistry video.",icon:"video-alt3",category:"optio-dentistry",attributes:{videoId:{type:"string"},language:{type:"string",default:"en"},valid:{type:"boolean",default:!1}},edit:function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?k(e):t}(this,S(t).apply(this,arguments))).openModal=e.openModal.bind(k(e)),e.closeModal=e.closeModal.bind(k(e)),e.updateVideoId=e.updateVideoId.bind(k(e)),e.validateVideoId=e.validateVideoId.bind(k(e)),e.state={modalOpen:!1},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(t,e),function(e,t,o){t&&E(e.prototype,t),o&&E(e,o)}(t,[{key:"openModal",value:function(){this.setState({modalOpen:!0})}},{key:"closeModal",value:function(){this.setState({modalOpen:!1})}},{key:"updateVideoId",value:function(e){this.props.setAttributes({videoId:e,valid:!0}),this.forceUpdate(this.componentDidMount)}},{key:"validateVideoId",value:function(){this.props.setAttributes({valid:!0}),this.forceUpdate(this.componentDidMount)}},{key:"render",value:function(){var e=this,t=wp.element.createElement(j,null,wp.element.createElement(L,{title:"Video",initialOpen:!1},wp.element.createElement(x,{className:"optio-inspector__control",label:"Video ID",value:this.props.attributes.videoId,onChange:function(t){return e.props.setAttributes({videoId:t})}}),wp.element.createElement(T,{className:"optio-inspector__control",label:"Language",value:this.props.attributes.language,options:[{label:"English",value:"en"},{label:"Français",value:"fr"},{label:"Espanõl",value:"es"}],onChange:function(t){return e.props.setAttributes({language:t})}})));if(this.props.attributes.valid){var o="optio-video-"+this.props.clientId;return wp.element.createElement(F,null,t,wp.element.createElement("div",{id:o}))}return wp.element.createElement(F,null,t,wp.element.createElement("div",{class:"optio-video__placeholder"},wp.element.createElement(O,{isOpen:this.state.modalOpen,onRequestClose:this.closeModal,onSelectVideo:this.updateVideoId}),wp.element.createElement(D,{icon:"video-alt3",label:"Optio Dentistry Video",instructions:"Enter video ID below or browse.",isColumnLayout:"true"},wp.element.createElement("div",{class:"optio-video__placeholder__input-group"},wp.element.createElement(x,{className:"optio-video__placeholder__input",label:"Video ID",hideLabelFromVision:"true",value:this.props.attributes.videoId,onChange:this.updateVideoId}),wp.element.createElement(I,{className:"optio-video__placeholder__browse-button",isDefault:!0,isLarge:!0,onClick:this.openModal},"Browse"),wp.element.createElement(I,{className:"optio-video__placeholder__embed-button",isDefault:!0,isLarge:!0,onClick:this.validateVideoId},"Embed")),wp.element.createElement(M,{href:"https://www.optiopublishing.com/how-to-embed/video-ids"},"View full list of video IDs"))))}},{key:"componentDidMount",value:function(){var e=this,t="optio-video-"+this.props.clientId;"undefined"==typeof optio?addEventListener("load",(function(){optio.VideoPlayer(t,e.props.attributes.videoId)})):optio.VideoPlayer(t,this.props.attributes.videoId)}}]),t}(N),save:function(e){return'[optio-video id="'+e.attributes.videoId+'" language="'+e.attributes.language+'"]'}});var J=wp.element,Q=J.Component,z=J.Fragment,H=window.wp.richText,K=H.registerFormatType,W=(H.applyFormat,H.removeFormat,H.toggleFormat),X=window.wp.blockEditor.RichTextToolbarButton;K("optio-dentistry/optio-link",{title:"Link to Video",tagName:"a",className:"optio-link",edit:function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?G(e):t}(this,q(t).apply(this,arguments))).openModal=e.openModal.bind(G(e)),e.closeModal=e.closeModal.bind(G(e)),e.insertLink=e.insertLink.bind(G(e)),e.updateVideoId=e.updateVideoId.bind(G(e)),e.state={modalOpen:!1},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(t,e),function(e,t,o){t&&A(e.prototype,t),o&&A(e,o)}(t,[{key:"openModal",value:function(){this.setState({modalOpen:!0})}},{key:"closeModal",value:function(){this.setState({modalOpen:!1})}},{key:"insertLink",value:function(){this.props.isActive?this.props.onChange(W(this.props.value,{type:"optio-dentistry/optio-link"})):this.openModal()}},{key:"updateVideoId",value:function(e){this.props.onChange(W(this.props.value,{type:"optio-dentistry/optio-link",attributes:{href:'javascript:optio.openLightbox("'+e+'")'}}))}},{key:"render",value:function(){return wp.element.createElement(z,null,wp.element.createElement(X,{icon:"video-alt3",title:"Link to Optio Dentistry video",onClick:this.insertLink,isActive:this.props.isActive}),wp.element.createElement(O,{isOpen:this.state.modalOpen,onRequestClose:this.closeModal,onSelectVideo:this.updateVideoId}))}}]),t}(Q)})}]);